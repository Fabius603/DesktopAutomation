<mah:MetroWindow x:Class="DesktopAutomationApp.Views.AddStepDialog"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
                 Title="{Binding DialogTitle}" Height="260" Width="420"
                 WindowStartupLocation="CenterOwner"
                 ResizeMode="NoResize" ShowInTaskbar="False">
    <mah:MetroWindow.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
    </mah:MetroWindow.Resources>

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Typauswahl -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,8">
            <TextBlock Text="Typ:" VerticalAlignment="Center" Margin="0,0,8,0"/>
            <ComboBox Width="180" ItemsSource="{Binding StepTypes}" SelectedItem="{Binding SelectedType}"/>
        </StackPanel>

        <!-- Dynamische Felder -->
        <StackPanel Grid.Row="1" Margin="0,0,0,8">
            <!-- Maus: X/Y -->
            <StackPanel Orientation="Horizontal" Visibility="{Binding ShowMouseXY, Converter={StaticResource BoolToVis}}">
                <TextBlock Text="X:" VerticalAlignment="Center" Margin="0,0,4,0"/>
                <TextBox Width="60" Text="{Binding X}"/>
                <TextBlock Text="  Y:" VerticalAlignment="Center" Margin="8,0,4,0"/>
                <TextBox Width="60" Text="{Binding Y}"/>
            </StackPanel>

            <!-- Maus: Button -->
            <StackPanel Orientation="Horizontal" Margin="0,6,0,0" Visibility="{Binding ShowMouseButton, Converter={StaticResource BoolToVis}}">
                <TextBlock Text="Button:" VerticalAlignment="Center" Margin="0,0,4,0"/>
                <ComboBox Width="100" SelectedValuePath="Content" SelectedValue="{Binding MouseButton}">
                    <ComboBoxItem Content="Left"/>
                    <ComboBoxItem Content="Right"/>
                    <ComboBoxItem Content="Middle"/>
                </ComboBox>
            </StackPanel>

            <!-- Key -->
            <StackPanel Orientation="Horizontal" Margin="0,6,0,0"
            Visibility="{Binding ShowKey, Converter={StaticResource BoolToVis}}">
                <TextBlock Text="Key:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBlock Width="160" VerticalAlignment="Center"
               Text="{Binding Key}" />
                <Button Command="{Binding CaptureKeyCommand}" Margin="8,0,0,0">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                            <Setter Property="Content" Value="Aufnehmen"/>
                            <Setter Property="IsEnabled" Value="True"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsCapturing}" Value="True">
                                    <Setter Property="Content" Value="Aufnahme läuft…"/>
                                    <Setter Property="IsEnabled" Value="False"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </StackPanel>

            <!-- Timeout -->
            <StackPanel Orientation="Horizontal" Margin="0,6,0,0" Visibility="{Binding ShowDuration, Converter={StaticResource BoolToVis}}">
                <TextBlock Text="Duration (ms):" VerticalAlignment="Center" Margin="0,0,4,0"/>
                <TextBox Width="80" Text="{Binding Duration}"/>
            </StackPanel>
        </StackPanel>

        <!-- Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="Abbrechen" IsCancel="True" Margin="0,0,8,0" Click="Cancel_Click"/>
            <Button Content="{Binding ConfirmButtonText}" IsDefault="True" Click="Ok_Click"/>
        </StackPanel>
    </Grid>
</mah:MetroWindow>
